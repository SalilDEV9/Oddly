<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JARBES HUB | Engine v2.0</title>
    <script src="https://www.youtube.com/iframe_api"></script>
    <style>
        :root { --bg: #050505; --surface: #111; --accent: #00d4ff; --text: #eee; }
        body { margin: 0; font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; }
        header { padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #222; background: var(--surface); }
        .search-container { display: flex; width: 40%; background: #000; border: 1px solid #333; border-radius: 20px; padding: 5px 15px; }
        input { flex: 1; background: transparent; border: none; color: white; outline: none; padding: 8px; }
        button { background: transparent; border: none; color: var(--accent); cursor: pointer; font-size: 1.2rem; }
        main { display: grid; grid-template-columns: 1fr 350px; flex: 1; overflow: hidden; }
        #player-box { background: #000; display: flex; align-items: center; padding: 20px; }
        #player { width: 100%; aspect-ratio: 16/9; border-radius: 8px; box-shadow: 0 0 20px rgba(0,212,255,0.1); }
        #sidebar { background: var(--surface); border-left: 1px solid #222; overflow-y: auto; padding: 15px; }
        .v-card { display: flex; gap: 10px; padding: 10px; margin-bottom: 8px; border-radius: 8px; cursor: pointer; font-size: 0.85rem; border: 1px solid transparent; }
        .v-card:hover { background: #1a1a1a; }
        .v-card.active { background: #00d4ff15; border-color: var(--accent); }
        .v-card img { width: 110px; border-radius: 4px; }
    </style>
</head>
<body>

<header>
    <div style="font-weight: 800; color: var(--accent);">JARBES <span style="color:#fff">ENGINE</span></div>
    <div class="search-container">
        <input type="text" id="query" placeholder="Search Arijit Singh or any song...">
        <button id="search-btn">âŒ•</button>
    </div>
</header>

<main>
    <div id="player-box"><div id="player"></div></div>
    <div id="sidebar">
        <div style="font-size: 0.7rem; color: var(--accent); letter-spacing: 1px; margin-bottom: 10px;">AUTO-PLAY QUEUE</div>
        <div id="queue"></div>
    </div>
</main>

<script>
    const KEY = 'AIzaSyBUB6X7AvsG6z0gNtgcIdqx_C8Ssvm2B5w';
    let player, state = { list: [], idx: 0 };

    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            playerVars: { 'autoplay': 1, 'modestbranding': 1 },
            events: { 'onStateChange': (e) => e.data === 0 && next(), 'onError': () => next() }
        });
    }

    async function runSearch() {
        const q = document.getElementById('query').value;
        if (!q) return;

        // ENGINEER'S CHANGE: Broad search to avoid "No results" due to strict filters
        const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=15&q=${encodeURIComponent(q)}&type=video&key=${KEY}`;
        
        try {
            const res = await fetch(url);
            const data = await res.json();
            if (data.items?.length > 0) {
                state.list = data.items;
                playVideo(0);
            } else { alert("No results found. Try again, Sir."); }
        } catch (e) { console.error("API Error:", e); }
    }

    function playVideo(i) {
        state.idx = i;
        const id = state.list[i].id.videoId;
        player.loadVideoById(id);
        renderQueue();
    }

    function next() {
        if (state.idx < state.list.length - 1) playVideo(state.idx + 1);
    }

    function renderQueue() {
        document.getElementById('queue').innerHTML = state.list.map((v, i) => `
            <div class="v-card ${i === state.idx ? 'active' : ''}" onclick="playVideo(${i})">
                <img src="${v.snippet.thumbnails.default.url}">
                <div>${v.snippet.title}</div>
            </div>`).join('');
    }

    document.getElementById('search-btn').onclick = runSearch;
    document.getElementById('query').onkeypress = (e) => e.key === 'Enter' && runSearch();
</script>
</body>
</html>
